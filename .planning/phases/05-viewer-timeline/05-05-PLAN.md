---
phase: 05-viewer-timeline
plan: 05
type: execute
depends_on: []
files_modified: [src/lib/links.ts, src/app/api/links/timeline/route.ts, src/components/Timeline.tsx, src/app/page.tsx]
---

<objective>
'과거의 오늘' 타임라인 기능 - 1년 전 오늘 저장한 콘텐츠 표시

Purpose: 과거 콘텐츠 재발견으로 아카이브 활용도 증가
Output: 타임라인 API, 타임라인 UI 섹션
</objective>

<execution_context>
./.claude/get-shit-done/workflows/execute-plan.md
./summary.md
./.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@src/lib/links.ts
@src/types/database.ts

**Requirements from PROJECT.md:**
- 타임라인: '과거의 오늘' 1년 전 콘텐츠 표시 (수동 확인)

**Database:**
- links.original_date: 콘텐츠 원본 날짜 (DATE)
- links.created_at: 저장 날짜 (TIMESTAMPTZ)
</context>

<tasks>

<task type="auto">
  <name>Task 1: 타임라인 API 구현</name>
  <files>src/lib/links.ts, src/app/api/links/timeline/route.ts</files>
  <action>
1. src/lib/links.ts에 함수 추가:
   - getLinksOnThisDay(yearsAgo: number = 1):
     - original_date 또는 created_at이 N년 전 오늘과 같은 링크 조회
     - 월/일 기준 비교 (EXTRACT로 month, day 비교)
     - 태그 포함해서 반환

2. src/app/api/links/timeline/route.ts 생성:
   - GET /api/links/timeline
   - Query params: years (기본값 1)
   - getLinksOnThisDay() 호출
   - 빈 배열이면 204 No Content 또는 빈 배열 반환
  </action>
  <verify>curl "/api/links/timeline" 응답 확인</verify>
  <done>타임라인 API가 과거의 오늘 콘텐츠 반환</done>
</task>

<task type="auto">
  <name>Task 2: 타임라인 UI 섹션</name>
  <files>src/components/Timeline.tsx, src/app/page.tsx</files>
  <action>
1. src/components/Timeline.tsx 생성:
   - 페이지 상단 또는 사이드바에 표시
   - "N년 전 오늘" 헤더
   - 링크 카드 가로 스크롤 또는 캐러셀
   - 콘텐츠 없으면 숨김 또는 "과거의 오늘 콘텐츠가 없습니다" 메시지
   - 날짜 표시 (예: "2025년 1월 13일")

2. src/app/page.tsx 수정:
   - Timeline 컴포넌트 추가 (메인 리스트 위)
   - 페이지 로드 시 타임라인 API 호출

3. 스타일:
   - 구분선으로 섹션 분리
   - 다크모드 지원
   - 접기/펼치기 (선택적)
  </action>
  <verify>페이지에 타임라인 섹션 표시</verify>
  <done>타임라인 UI가 과거의 오늘 콘텐츠 표시</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>'과거의 오늘' 타임라인 기능</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. 메인 페이지 상단에 타임라인 섹션 확인
    3. (테스트 데이터 필요) 1년 전 날짜로 링크 저장 후 확인
    4. 타임라인에 콘텐츠 없을 때 적절한 메시지/숨김 확인
    5. 타임라인 링크 클릭 시 정상 작동
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] npm run build 성공
- [ ] 타임라인 API 응답 정상
- [ ] 타임라인 UI 섹션 표시
- [ ] 콘텐츠 없을 때 적절한 처리
</verification>

<success_criteria>
- 타임라인 API가 N년 전 오늘 콘텐츠 반환
- 메인 페이지에 타임라인 섹션 표시
- 가로 스크롤/캐러셀로 여러 콘텐츠 탐색
- Phase 5 complete
- User verification passed
</success_criteria>

<output>
After completion, create `.planning/phases/05-viewer-timeline/05-05-SUMMARY.md`
</output>
