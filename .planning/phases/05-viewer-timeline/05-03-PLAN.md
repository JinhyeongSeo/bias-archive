---
phase: 05-viewer-timeline
plan: 03
type: execute
depends_on: ["05-01"]
files_modified: [src/components/EmbedViewer.tsx, src/components/LinkCard.tsx, src/components/ViewerModal.tsx]
---

<objective>
임베드 뷰어 구현 - YouTube/Twitter 콘텐츠를 앱 내에서 직접 시청

Purpose: 원본 링크로 이동하지 않고 앱 내에서 콘텐츠 시청 가능하게 함
Output: EmbedViewer 컴포넌트, ViewerModal, LinkCard 뷰어 버튼
</objective>

<execution_context>
./.claude/get-shit-done/workflows/execute-plan.md
./summary.md
./.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@src/components/LinkCard.tsx
@src/types/database.ts

**Embed patterns:**
- YouTube: iframe src="https://www.youtube.com/embed/{videoId}"
- Twitter: Twitter widgets.js로 동적 로드 또는 iframe

**05-01 provides:**
- LinkWithMedia 타입 (media 배열 포함)
</context>

<tasks>

<task type="auto">
  <name>Task 1: EmbedViewer 컴포넌트 생성</name>
  <files>src/components/EmbedViewer.tsx</files>
  <action>
src/components/EmbedViewer.tsx 생성:

1. Props: url, platform, media (optional)

2. YouTube embed:
   - URL에서 videoId 추출 (watch?v=, youtu.be/, shorts/ 지원)
   - iframe: width="100%", aspect-ratio 16:9
   - allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"

3. Twitter embed:
   - Twitter publish API 또는 정적 iframe 사용
   - tweet ID 추출 후 https://platform.twitter.com/embed/Tweet.html?id={id} 사용
   - 대안: twttr.widgets.createTweet() (widgets.js 동적 로드)

4. 다중 미디어 (Twitter 이미지):
   - media 배열이 있으면 이미지 갤러리로 표시
   - 간단한 좌우 네비게이션

5. Fallback: 지원하지 않는 플랫폼은 "원본 링크 열기" 버튼
  </action>
  <verify>TypeScript 컴파일 성공, 컴포넌트 import 가능</verify>
  <done>EmbedViewer 컴포넌트가 YouTube/Twitter를 임베드로 표시</done>
</task>

<task type="auto">
  <name>Task 2: ViewerModal 및 LinkCard 통합</name>
  <files>src/components/ViewerModal.tsx, src/components/LinkCard.tsx</files>
  <action>
1. src/components/ViewerModal.tsx 생성:
   - 전체 화면 오버레이 모달
   - EmbedViewer 표시
   - 닫기 버튼 (X, ESC 키)
   - 링크 정보 (제목, 태그) 표시
   - 원본 링크 열기 버튼

2. src/components/LinkCard.tsx 수정:
   - "재생/보기" 버튼 추가 (hover 시 표시)
   - 클릭 시 ViewerModal 열기
   - 썸네일 클릭으로도 뷰어 열기 가능

3. 스타일:
   - 다크모드 지원
   - 모바일 반응형 (전체 화면)
  </action>
  <verify>LinkCard에서 재생 버튼 클릭 시 모달 열림</verify>
  <done>LinkCard에서 뷰어 모달로 콘텐츠 재생 가능</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>임베드 뷰어 (YouTube/Twitter 앱 내 재생)</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. 저장된 YouTube 링크 카드에서 재생 버튼 클릭
    3. 모달에서 YouTube 영상 재생 확인
    4. ESC 또는 X 버튼으로 모달 닫기
    5. 저장된 Twitter 링크로 동일 테스트
    6. 모바일 뷰포트에서 레이아웃 확인
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] npm run build 성공
- [ ] YouTube 영상 임베드 재생
- [ ] Twitter 트윗 임베드 표시
- [ ] 모달 열기/닫기 정상
- [ ] 다크모드 지원
</verification>

<success_criteria>
- EmbedViewer가 YouTube/Twitter 콘텐츠 임베드
- ViewerModal로 전체 화면 뷰어 제공
- LinkCard에서 뷰어 열기 가능
- User verification passed
</success_criteria>

<output>
After completion, create `.planning/phases/05-viewer-timeline/05-03-SUMMARY.md`
</output>
