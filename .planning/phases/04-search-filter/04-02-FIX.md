---
phase: 04-search-filter
plan: 02-FIX
type: fix
---

<objective>
Fix 2 UAT issues from plan 04-02.

Source: 04-02-ISSUES.md
Priority: 0 critical, 1 major, 1 minor
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/ROADMAP.md

**Issues being fixed:**
@.planning/phases/04-search-filter/04-02-ISSUES.md

**Original plan for reference:**
@.planning/phases/04-search-filter/04-02-PLAN.md

**Files to modify:**
@src/components/ExternalSearch.tsx
@src/components/Sidebar.tsx
@src/app/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Fix UAT-001: 외부 검색을 모달로 변경하여 충분한 공간 확보</name>
  <files>
    src/components/ExternalSearch.tsx
    src/components/Sidebar.tsx
    src/app/page.tsx
  </files>
  <action>
현재 ExternalSearch가 240px 너비의 Sidebar 안에 렌더링되어 공간이 부족함.

해결 방안: 외부 검색을 모달/오버레이로 변경하여 화면 중앙에 충분한 공간으로 표시

1. ExternalSearch.tsx 수정:
   - 컴포넌트를 모달 형태로 변경 (isOpen prop 추가)
   - 모달 배경 오버레이 추가
   - 검색 결과 영역 너비 확장 (min-w-[400px] 또는 max-w-lg)
   - 닫기 버튼 추가
   - ESC 키로 닫기 지원

2. Sidebar.tsx 수정:
   - 외부 검색 섹션을 버튼으로 변경 (토글이 아닌 모달 열기)
   - ExternalSearch 컴포넌트 제거 (page.tsx로 이동)

3. page.tsx 수정:
   - ExternalSearch 모달 상태 관리 (isExternalSearchOpen)
   - Sidebar에서 모달 열기 콜백 전달
   - ExternalSearch를 최상위에 렌더링

레이아웃 개선:
- 검색 결과 아이템: 썸네일 크기 확대 (w-24 h-16 또는 w-32 h-20)
- 제목: line-clamp-2 유지하되 폰트 크기 text-sm으로
- 채널/작성자: 충분한 공간 확보
  </action>
  <verify>
npm run build 성공
브라우저에서 외부 검색 버튼 클릭 시 모달로 표시
검색 결과가 충분한 공간에서 깔끔하게 보임
  </verify>
  <done>
외부 검색이 모달로 표시되고 레이아웃이 깨지지 않음
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>외부 검색을 모달로 변경하여 레이아웃 개선</what-built>
  <how-to-verify>
    1. npm run dev로 앱 실행
    2. Sidebar에서 '외부 검색' 버튼 클릭
    3. 모달이 화면 중앙에 표시되는지 확인
    4. YouTube 검색 수행 - 결과가 깔끔하게 표시되는지 확인
    5. Twitter 검색 수행 - 결과가 깔끔하게 표시되는지 확인
    6. ESC 키 또는 닫기 버튼으로 모달 닫기
    7. 저장 기능이 정상 작동하는지 확인
  </how-to-verify>
  <resume-signal>Type "approved" or describe issues</resume-signal>
</task>

<task type="auto">
  <name>Fix UAT-002: 검색 결과 저장 시 검색어 기반 태그 추천</name>
  <files>
    src/components/ExternalSearch.tsx
  </files>
  <action>
현재 Twitter 검색 결과 저장 시 메타데이터에 멤버명이 없으면 태그가 붙지 않음.

해결 방안: 검색어를 활용한 태그 추천

1. handleSave 함수 수정:
   - 저장 시 현재 검색어(query)를 참고하여 태그 후보로 전달
   - POST /api/links 요청에 suggestedTag: query 추가

2. 또는 저장 전 태그 선택 UI 추가:
   - 저장 버튼 클릭 시 간단한 태그 선택 팝오버
   - 기존 태그 목록에서 선택 가능
   - 검색어를 기본 추천으로 표시

심플한 접근: 저장 API 호출 시 searchQuery를 함께 전달하여 백엔드에서 태그 매칭 시도

Note: 이 이슈는 Minor이므로 심플한 접근 우선. 검색어를 태그 추출에 힌트로 활용.
  </action>
  <verify>
npm run build 성공
Twitter 검색 후 저장 시 태그가 적용되는지 확인
  </verify>
  <done>
검색 결과 저장 시 검색어 기반으로 태그 추천/적용됨
  </done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] All critical issues fixed
- [ ] All major issues fixed
- [ ] Minor issues fixed or documented as deferred
- [ ] Original acceptance criteria from issues met
- [ ] npm run build succeeds
- [ ] npm run lint passes
</verification>

<success_criteria>
- UAT-001: 외부 검색 결과가 충분한 공간에서 표시됨
- UAT-002: 검색 결과 저장 시 태그 추천 개선
- Tests pass
- Ready for re-verification
</success_criteria>

<output>
After completion, create `.planning/phases/04-search-filter/04-02-FIX-SUMMARY.md`
</output>
