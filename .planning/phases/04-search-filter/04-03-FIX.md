---
phase: 04-search-filter
plan: 04-03-FIX
type: fix
---

<objective>
Fix savedUrls state not updating after link deletion.

Issue: When a link is deleted from LinkList, the ExternalSearch modal still shows "저장됨" status because savedUrls state in page.tsx is not refreshed.

Root cause: LinkList only calls onLinksLoad on initial fetch, not after deletions. The savedUrls array in page.tsx becomes stale.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/ROADMAP.md
@src/app/page.tsx
@src/components/LinkList.tsx
@src/components/ExternalSearch.tsx
</context>

<tasks>
<task type="auto">
  <name>Task 1: Update savedUrls after link deletion</name>
  <files>src/components/LinkList.tsx, src/app/page.tsx</files>
  <action>
Fix the stale savedUrls state by ensuring onLinksLoad is called after deletions:

Option A (Recommended - cleanest):
In LinkList.tsx handleDelete function, after removing from local state, call onLinksLoad with the updated URLs:
```typescript
const handleDelete = (id: string) => {
  setLinks((prev) => {
    const updated = prev.filter((link) => link.id !== id)
    // Notify parent of updated URLs
    if (onLinksLoad) {
      onLinksLoad(updated.map((link) => link.url))
    }
    return updated
  })
}
```

This ensures savedUrls in page.tsx is synchronized whenever a link is deleted.

Alternative consideration: Could also add a useEffect that calls onLinksLoad whenever `links` state changes, but the inline approach above is more explicit and predictable.
  </action>
  <verify>
1. Run `npm run build` - no errors
2. Manual test:
   - Open ExternalSearch modal
   - Search for a YouTube video
   - Save it (should show "저장됨")
   - Close modal, delete the link from LinkList
   - Reopen ExternalSearch, search same video
   - Should show "저장" button (not "저장됨")
  </verify>
  <done>
- Deleting a link properly updates savedUrls state
- ExternalSearch modal shows correct "저장됨"/"저장" status after deletion
- Can re-save a previously deleted link
  </done>
</task>
</tasks>

<verification>
Before declaring plan complete:
- [ ] npm run build succeeds
- [ ] Deleted links no longer show "저장됨" in ExternalSearch
- [ ] Can save the same link again after deletion
</verification>

<success_criteria>
- savedUrls state properly synchronized after link deletion
- ExternalSearch modal displays accurate saved status
- No regression in existing save functionality
</success_criteria>

<output>
After completion, create `.planning/phases/04-search-filter/04-03-FIX-SUMMARY.md`
</output>
