---
phase: 20-authentication
plan: 02
type: execute
depends_on: ["20-01"]
files_modified: [src/components/AuthProvider.tsx, src/components/AuthForm.tsx, src/components/Header.tsx, src/app/[locale]/login/page.tsx, src/app/[locale]/signup/page.tsx, messages/ko.json, messages/en.json]
---

<objective>
인증 UI 컴포넌트 구현: 로그인/회원가입 폼, AuthProvider, Header 인증 상태 표시

Purpose: 사용자가 로그인/회원가입할 수 있는 UI 제공
Output: 로그인/회원가입 페이지, Header에 로그인 버튼/사용자 메뉴
</objective>

<execution_context>
./.claude/get-shit-done/workflows/execute-plan.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/20-authentication/20-01-SUMMARY.md (after Plan 01)
@src/components/Header.tsx
@src/app/[locale]/layout.tsx

**Tech stack:**
- next-intl for i18n
- next-themes for dark mode
- Tailwind CSS

**Established patterns:**
- [locale] routing (ko, en)
- messages/*.json for translations
- Header에 토글 버튼들 배치
</context>

<tasks>

<task type="auto">
  <name>Task 1: AuthProvider 및 useAuth 훅 생성</name>
  <files>src/components/AuthProvider.tsx, src/hooks/useAuth.ts</files>
  <action>
1. src/components/AuthProvider.tsx 생성:
   - React Context로 인증 상태 관리
   - Supabase onAuthStateChange 구독
   - user, loading, signIn, signUp, signOut 제공
   - 'use client' 지시어 필수

2. src/hooks/useAuth.ts 생성:
   - useContext로 AuthContext 접근
   - null 체크 및 에러 처리

3. src/components/Providers.tsx 수정:
   - AuthProvider 추가 (ThemeProvider와 함께)

구현 시 주의:
- SSR에서는 초기 상태가 null일 수 있음
- 클라이언트에서 onAuthStateChange로 실제 상태 로드
- loading 상태로 hydration mismatch 방지
  </action>
  <verify>npm run build 성공, AuthProvider import 가능</verify>
  <done>AuthProvider 컴포넌트와 useAuth 훅 생성됨, Providers에 통합됨</done>
</task>

<task type="auto">
  <name>Task 2: 로그인/회원가입 페이지 및 폼 컴포넌트</name>
  <files>src/components/AuthForm.tsx, src/app/[locale]/login/page.tsx, src/app/[locale]/signup/page.tsx, messages/ko.json, messages/en.json</files>
  <action>
1. src/components/AuthForm.tsx 생성:
   - 이메일/비밀번호 입력 폼 (공통 컴포넌트)
   - mode prop: 'login' | 'signup'
   - 에러 메시지 표시
   - 로딩 상태 표시
   - 성공 시 홈으로 리다이렉트
   - 다크모드 스타일 적용

2. src/app/[locale]/login/page.tsx 생성:
   - AuthForm mode="login" 사용
   - "계정이 없으신가요? 회원가입" 링크
   - 페이지 타이틀 설정

3. src/app/[locale]/signup/page.tsx 생성:
   - AuthForm mode="signup" 사용
   - "이미 계정이 있으신가요? 로그인" 링크
   - 이메일 확인 안내 메시지 (Supabase 기본 설정)

4. messages/ko.json, messages/en.json 업데이트:
   - auth.login, auth.signup, auth.email, auth.password
   - auth.loginButton, auth.signupButton
   - auth.noAccount, auth.hasAccount
   - auth.loginError, auth.signupError, auth.signupSuccess

스타일: 기존 앱 디자인 패턴 따름 (zinc 색상, rounded-lg, border)
  </action>
  <verify>npm run dev로 /ko/login, /en/signup 페이지 렌더링 확인</verify>
  <done>AuthForm 컴포넌트, 로그인/회원가입 페이지 생성됨, 다국어 메시지 추가됨</done>
</task>

<task type="auto">
  <name>Task 3: Header에 인증 상태 표시</name>
  <files>src/components/Header.tsx, src/components/UserMenu.tsx, messages/ko.json, messages/en.json</files>
  <action>
1. src/components/UserMenu.tsx 생성:
   - 로그인 상태: 사용자 이메일 표시 + 드롭다운 메뉴
   - 드롭다운: 로그아웃 버튼
   - 비로그인 상태: 로그인 버튼
   - 로딩 중: 스켈레톤 또는 빈 상태

2. src/components/Header.tsx 수정:
   - UserMenu 컴포넌트 추가 (토글 버튼들 옆)
   - 기존 레이아웃 유지

3. messages 업데이트:
   - auth.logout, auth.loginButton (nav용)

UI 패턴:
- 로그인 버튼: 기존 토글 버튼 스타일과 유사하게
- 드롭다운: zinc-800 배경, rounded-lg, shadow
  </action>
  <verify>npm run dev로 Header 렌더링 확인, 로그인/로그아웃 상태 전환 확인</verify>
  <done>UserMenu 컴포넌트 생성됨, Header에 통합됨, 인증 상태에 따라 UI 변경됨</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` 오류 없음
- [ ] /ko/login 페이지 렌더링됨
- [ ] /en/signup 페이지 렌더링됨
- [ ] Header에 로그인 버튼 또는 사용자 메뉴 표시됨
- [ ] 다국어 메시지 정상 작동
</verification>

<success_criteria>

- AuthProvider가 앱 전체에서 인증 상태 관리
- 로그인/회원가입 페이지에서 이메일/비밀번호 입력 가능
- Header에서 로그인 상태 확인 및 로그아웃 가능
- 한국어/영어 인터페이스 지원
  </success_criteria>

<output>
After completion, create `.planning/phases/20-authentication/20-02-SUMMARY.md`
</output>
