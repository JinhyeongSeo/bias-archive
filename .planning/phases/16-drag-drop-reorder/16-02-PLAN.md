---
phase: 16-drag-drop-reorder
plan: 02
type: execute
depends_on: ["16-01"]
files_modified: [package.json, src/components/BiasManager.tsx]
---

<objective>
@hello-pangea/dnd를 설치하고 BiasManager에 드래그 앤 드롭 기능을 구현한다.

Purpose: 사용자가 최애 목록의 순서를 드래그로 직관적으로 변경할 수 있게 한다.
Output: 드래그 앤 드롭으로 순서 변경 가능한 BiasManager 컴포넌트
</objective>

<execution_context>
./.claude/get-shit-done/workflows/execute-plan.md
./summary.md
./.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/16-drag-drop-reorder/DISCOVERY.md
@.planning/phases/16-drag-drop-reorder/16-01-SUMMARY.md
@src/components/BiasManager.tsx
@src/components/Sidebar.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: @hello-pangea/dnd 설치</name>
  <files>package.json</files>
  <action>
npm install @hello-pangea/dnd

React 19 호환 v18.0.0+ 버전이 설치되는지 확인.
peer dependency 경고 시 --legacy-peer-deps 플래그 사용하지 말고 최신 버전 확인.
  </action>
  <verify>package.json에 @hello-pangea/dnd 추가됨, npm run build 성공</verify>
  <done>@hello-pangea/dnd v18+ 설치 완료</done>
</task>

<task type="auto">
  <name>Task 2: BiasManager 드래그 앤 드롭 구현</name>
  <files>src/components/BiasManager.tsx</files>
  <action>
1. DragDropContext, Droppable, Draggable import from '@hello-pangea/dnd'

2. 그룹별 bias 목록에 드래그 앤 드롭 적용:
   - 각 그룹을 별도 Droppable로 구성 (droppableId = group.id || 'ungrouped')
   - 같은 그룹 내에서만 순서 변경 허용 (그룹 간 이동은 Phase 17 이후)
   - 각 bias를 Draggable로 래핑

3. onDragEnd 핸들러 구현:
   - source와 destination 확인
   - 같은 droppableId 내에서만 처리 (다른 그룹으로 이동 시 무시)
   - 로컬 상태 먼저 업데이트 (optimistic update)
   - PUT /api/biases/reorder 호출하여 서버 저장
   - 실패 시 롤백

4. 드래그 핸들 UI 추가:
   - 각 bias 항목 왼쪽에 드래그 핸들 아이콘 (6개 점 또는 그리퍼)
   - hover 시에만 표시되던 삭제 버튼과 함께 배치

5. 드래그 중 스타일:
   - 드래그 중인 항목에 그림자 효과
   - placeholder 영역 표시

주의사항:
- 'use client' 지시문 유지 (이미 있음)
- StrictMode 호환성 확인 (hello-pangea/dnd는 지원함)
- 그룹 접기/펼치기 상태와 드래그 상호작용 고려
  </action>
  <verify>npm run build 성공, 개발 서버에서 드래그 동작 확인</verify>
  <done>BiasManager에서 드래그로 순서 변경 가능, 서버에 저장됨</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>BiasManager 드래그 앤 드롭 순서 변경 기능</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Visit: http://localhost:3000
    3. 사이드바의 최애 목록에서 항목 드래그 시도
    4. Confirm: 드래그 핸들이 표시되고, 드래그 시 항목이 움직임
    5. Confirm: 드래그 완료 후 순서가 변경되고 유지됨
    6. 페이지 새로고침 후에도 변경된 순서 유지 확인
    7. 모바일 터치 드래그도 테스트 (DevTools 모바일 뷰)
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `npm run build` 성공
- [ ] 드래그 앤 드롭으로 순서 변경 가능
- [ ] 변경된 순서가 DB에 저장됨
- [ ] 페이지 새로고침 후에도 순서 유지
- [ ] 모바일 터치 드래그 동작
</verification>

<success_criteria>

- 모든 tasks 완료
- 드래그 앤 드롭 UI 직관적으로 동작
- 순서 변경이 서버에 영구 저장
- Phase 16 complete
</success_criteria>

<output>
After completion, create `.planning/phases/16-drag-drop-reorder/16-02-SUMMARY.md`:

# Phase 16 Plan 02: Drag & Drop UI Summary

**[한 줄 요약]**

## Accomplishments

- [Key outcome 1]
- [Key outcome 2]

## Files Created/Modified

- `path/to/file.ts` - Description

## Decisions Made

[Key decisions and rationale, or "None"]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Step

Phase 16 complete, ready for Phase 17 (heye.kr iframe Embed)
</output>
