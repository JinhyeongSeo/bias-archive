---
phase: 28-selca-search-ux
plan: 01
---

<objective>
Selca 검색을 한글로도 가능하도록 UX 개선 - Bias 드롭다운 활용 + 기본 한영 매핑

**Why:** 현재 selca는 영문 이름("winter")으로만 검색 가능, 한글("윈터")로는 404 에러 발생
**What:** Bias 드롭다운 + 주요 아이돌 한영 매핑으로 한글 검색 지원
**Output:** 한글로 아이돌 검색 시 정상 작동 (영문으로 자동 변환)
</objective>

<context>
@.planning/STATE.md
@.planning/ROADMAP.md
@.planning/phases/28-selca-search-ux/CONTEXT.md

**Key files:**
@src/components/UnifiedSearch.tsx
@src/app/api/search/selca/route.ts
@src/lib/parsers/selca.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: 주요 아이돌 한영 매핑 상수 추가</name>
  <files>src/components/UnifiedSearch.tsx</files>
  <action>
  UnifiedSearch.tsx 상단에 한영 매핑 상수 추가:

  1. IDOL_NAME_MAP 객체 생성 (상위 30명 정도):
     - aespa: 카리나→karina, 윈터→winter, 지젤→giselle, 닝닝→ningning
     - IVE: 유진→yujin, 원영→wonyoung, 가을→gaeul, 리즈→liz, 레이→rei, 이서→leeseo
     - NewJeans: 민지→minji, 하니→hanni, 다니엘→danielle, 해린→haerin, 혜인→hyein
     - BLACKPINK: 지수→jisoo, 제니→jennie, 로제→rose, 리사→lisa
     - (G)I-DLE: 미연→miyeon, 민니→minnie, 소연→soyeon, 우기→yuqi, 슈화→shuhua
     - TWICE 주요 멤버 추가
     - Red Velvet 주요 멤버 추가

  2. normalizeIdolName 헬퍼 함수 생성:
     ```typescript
     function normalizeIdolName(query: string): string {
       const normalized = query.trim().toLowerCase()
       return IDOL_NAME_MAP[normalized] || normalized
     }
     ```

  3. 주석으로 설명 추가:
     - 매핑 기준: 활동 중인 주요 그룹, 인기 멤버 우선
     - 업데이트 필요 시 이 객체에 추가
  </action>
  <verify>
  - IDOL_NAME_MAP 객체에 최소 25개 이상의 매핑 존재
  - normalizeIdolName("윈터") === "winter"
  - normalizeIdolName("winter") === "winter" (영문은 그대로)
  - normalizeIdolName("유진") === "yujin"
  </verify>
  <done>
  - IDOL_NAME_MAP 상수 추가됨 (25+ 매핑)
  - normalizeIdolName 함수 구현됨
  - 주석으로 사용법 설명 추가됨
  </done>
</task>

<task type="auto">
  <name>Task 2: Selca 검색 시 이름 자동 변환 적용</name>
  <files>src/components/UnifiedSearch.tsx</files>
  <action>
  searchSelca 함수에서 검색 전 이름 변환 적용:

  1. searchSelca 함수 찾기 (라인 856 근처)

  2. 검색어를 normalizeIdolName으로 변환:
     ```typescript
     const searchSelca = async (
       searchQuery: string,
       page: number = 1
     ): Promise<{ results: EnrichedResult[]; hasMore: boolean }> => {
       // 한글 → 영문 변환
       const normalizedQuery = normalizeIdolName(searchQuery)

       const params = new URLSearchParams({
         query: normalizedQuery, // 변환된 검색어 사용
         page: String(page),
         limit: String(API_FETCH_COUNT),
       })
       // ... 나머지 코드
     ```

  3. 콘솔 로그 추가 (디버깅용):
     ```typescript
     if (normalizedQuery !== searchQuery) {
       console.log(`[Selca Search] "${searchQuery}" → "${normalizedQuery}"`)
     }
     ```
  </action>
  <verify>
  - searchSelca 함수에서 normalizeIdolName 호출 확인
  - "윈터" 검색 시 콘솔에 변환 로그 출력
  - API 요청 파라미터에 변환된 이름 사용
  </verify>
  <done>
  - searchSelca에서 이름 자동 변환 구현
  - 변환 로그 추가 (디버깅용)
  - 영문 검색은 기존처럼 작동
  </done>
</task>

<task type="auto">
  <name>Task 3: Selca 탭 안내 메시지 추가</name>
  <files>src/components/UnifiedSearch.tsx</files>
  <action>
  Selca 플랫폼 선택 시 안내 메시지 추가:

  1. 기존 platform notice 영역 찾기 (라인 773-811 근처)
     - YouTube, Twitter, heye, kgirls에 이미 안내 메시지 있음

  2. selca 케이스 추가:
     ```typescript
     {platform === 'selca' && (
       <p className="h-full flex items-center text-sm text-purple-600 dark:text-purple-400 bg-purple-50 dark:bg-purple-900/20 px-4 rounded-lg">
         💡 아이돌을 선택하거나 영문 이름으로 검색하세요
       </p>
     )}
     ```

  3. 위치: 기존 platform notice 블록 내부 (kgirls-issue 다음)
  </action>
  <verify>
  - Selca 탭 선택 시 안내 메시지 표시
  - 메시지 색상이 보라색 테마와 일치
  - 다크모드에서도 정상 표시
  </verify>
  <done>
  - Selca 탭 안내 메시지 추가됨
  - 보라색 테마 적용
  - 다크모드 지원
  </done>
</task>

<task type="auto">
  <name>Task 4: Selca 검색 에러 메시지 개선</name>
  <files>src/app/api/search/selca/route.ts</files>
  <action>
  404 에러 메시지를 더 친절하게 변경:

  1. route.ts 파일에서 에러 응답 찾기 (라인 71-75)

  2. 에러 메시지 개선:
     ```typescript
     if (idols.length === 0) {
       return NextResponse.json(
         {
           error: '매칭되는 아이돌을 찾을 수 없습니다',
           hint: '영문 이름이나 아이돌 드롭다운을 사용해보세요',
         },
         { status: 404 }
       )
     }
     ```

  3. 프론트엔드에서 hint 표시:
     - UnifiedSearch.tsx의 searchSelca catch 블록 수정
     - error.hint가 있으면 함께 표시
  </action>
  <verify>
  - "매칭되는 아이돌을 찾을 수 없습니다" 에러 시 hint 포함
  - 프론트엔드에서 hint 메시지 표시
  - 에러 UX 개선됨
  </verify>
  <done>
  - API 에러 응답에 hint 추가
  - 프론트엔드에서 hint 표시
  - 더 친절한 에러 메시지
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
  Selca 검색 한글 지원 완료:
  - 주요 아이돌 한영 매핑 (25+ 명)
  - 검색어 자동 변환 (한글 → 영문)
  - 안내 메시지 추가
  - 에러 메시지 개선
  </what-built>
  <how-to-verify>
  1. 브라우저 새로고침 (Cmd+Shift+R)
  2. 통합검색 모달 열기
  3. Selca 탭 선택
  4. 안내 메시지 확인: "💡 아이돌을 선택하거나 영문 이름으로 검색하세요"
  5. 한글 검색 테스트:
     - "윈터" 입력 → 결과 표시 (김민정 미디어)
     - "유진" 입력 → 결과 표시 (최유진 미디어)
     - "카리나" 입력 → 결과 표시
  6. 콘솔 확인:
     - 변환 로그 출력 ("윈터" → "winter")
  7. 영문 검색도 여전히 작동:
     - "winter" 입력 → 결과 표시
  8. 매핑되지 않은 이름 테스트:
     - "알 수 없는 이름" 입력 → 에러 메시지 + hint 표시
  </how-to-verify>
  <resume-signal>Type "approved" if Korean search works correctly, or describe the issue</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] IDOL_NAME_MAP에 25개 이상 매핑 존재
- [ ] "윈터" 검색 시 결과 표시됨
- [ ] "유진", "카리나" 등 주요 아이돌 한글 검색 작동
- [ ] 영문 검색도 기존처럼 작동
- [ ] Selca 탭 안내 메시지 표시
- [ ] 에러 메시지에 hint 포함
- [ ] 콘솔에 변환 로그 출력
</verification>

<success_criteria>
- 한글 아이돌 이름 검색 시 자동으로 영문으로 변환되어 검색됨
- 주요 아이돌 (aespa, IVE, NewJeans, etc.) 한글 검색 지원
- 영문 검색은 기존처럼 작동 (breaking change 없음)
- 안내 메시지로 UX 개선
- 에러 메시지 개선으로 사용자 가이드
</success_criteria>

<output>
After completion, create `.planning/phases/28-selca-search-ux/28-01-SUMMARY.md`
</output>
