---
phase: 23-unified-search-ux-improvements
plan: 01
type: execute
depends_on: []
files_modified: [src/components/UnifiedSearch.tsx, messages/ko.json, messages/en.json]
---

<objective>
통합검색 아이돌 선택 UI 개선 - 그룹별 접기/펼치기, 용어 변경, 그룹 선택 지원

Purpose: 많은 그룹/아이돌을 관리하는 사용자를 위해 드롭다운 UX 향상
Output: 커스텀 드롭다운 UI로 그룹별 접기/펼치기, 그룹 또는 아이돌 단일 선택
</objective>

<execution_context>
./.claude/get-shit-done/workflows/execute-plan.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

**Phase 22 완료 상태**: selca.kastden.org 파서 통합, kpopnet.json 제거 완료

**현재 상태 분석:**
- UnifiedSearch.tsx line 1493-1507: `<select>` 드롭다운 사용 중
- BiasManager.tsx에 이미 그룹별 접기/펼치기 구현 (`toggleGroupCollapse`, `collapsedGroups`)
- 현재 "내 최애 선택" 라벨 → "아이돌 선택"으로 변경 필요
- 드롭다운이 단일 선택만 지원, 그룹 선택 불가

**변경 요구사항:**
1. "내 최애" → "아이돌" 용어 변경
2. select → 커스텀 드롭다운 (그룹별 접기/펼치기)
3. 그룹 헤더 클릭 시 그룹명으로 검색 (예: "아이브 IVE")
4. 아이돌 클릭 시 아이돌명으로 검색 (기존과 동일)
5. biases/groups props 변경 시 자동 반영 (이미 동작 중)

@src/components/UnifiedSearch.tsx
@src/components/BiasManager.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: 용어 변경 및 번역 파일 업데이트</name>
  <files>messages/ko.json, messages/en.json</files>
  <action>
  1. messages/ko.json에 UnifiedSearch 관련 키 추가:
     - "unifiedSearch.selectIdol": "아이돌 선택"
     - "unifiedSearch.noSelection": "선택 안함"

  2. messages/en.json에 대응하는 영어 키 추가:
     - "unifiedSearch.selectIdol": "Select Idol"
     - "unifiedSearch.noSelection": "No selection"

  기존 구조 유지하며 unifiedSearch 섹션 추가.
  </action>
  <verify>JSON 파일 파싱 성공 (npm run build에서 JSON 오류 없음)</verify>
  <done>번역 키 추가 완료, 양 언어 파일에 동일한 키 존재</done>
</task>

<task type="auto">
  <name>Task 2: 커스텀 아이돌/그룹 선택 드롭다운 구현</name>
  <files>src/components/UnifiedSearch.tsx</files>
  <action>
  현재 select 드롭다운을 커스텀 드롭다운으로 교체 (단일 선택 유지):

  1. 선택 타입 정의:
     - type Selection = { type: 'bias', id: string } | { type: 'group', id: string } | null

  2. 상태 변경:
     - 기존 selectedBiasId: string | null 제거
     - 신규 selection: Selection (그룹 또는 아이돌 단일 선택)
     - isIdolDropdownOpen: boolean
     - collapsedDropdownGroups: Set of string (드롭다운 내 그룹 접기 상태)

  3. 커스텀 드롭다운 UI 구현 (line 1491-1507 교체):
     - 버튼 클릭으로 드롭다운 열기/닫기
     - 드롭다운 외부 클릭 시 닫기 (useEffect + document click listener)
     - 선택된 항목 이름 표시 또는 "아이돌 선택"

  4. 드롭다운 내용:
     - 그룹별로 아이돌 묶어서 표시
     - 그룹 헤더 왼쪽: 화살표 아이콘 (클릭으로 접기/펼치기)
     - 그룹 헤더 텍스트: 클릭 시 그룹 선택 → 그룹명으로 검색
     - 아이돌 항목: 클릭 시 아이돌 선택 → 아이돌명으로 검색
     - 미분류(ungrouped) 아이돌도 표시 (그룹 헤더 없이)

  5. 검색 쿼리 연동:
     - 그룹 선택 시: "그룹한글명 그룹영어명" (예: "아이브 IVE")
     - 아이돌 선택 시: 아이돌.name_ko || 아이돌.name (기존과 동일)

  6. UI 스타일:
     - BiasManager와 일관된 디자인 (동일한 색상, 패딩)
     - max-h-60 overflow-y-auto로 스크롤 지원
     - framer-motion 애니메이션 적용 (기존 pressScale, quickSpring 활용)
     - 그룹 헤더는 bold, 아이돌은 indent

  BiasManager.tsx의 그룹 접기/펼치기 패턴 참고하되, localStorage 저장은 불필요 (모달 닫으면 리셋).
  </action>
  <verify>npm run build 성공, UnifiedSearch 모달에서 드롭다운 동작 확인</verify>
  <done>커스텀 드롭다운 구현 완료, 그룹별 접기/펼치기 동작, 그룹/아이돌 단일 선택 동작</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` 성공
- [ ] `npm run lint` 통과
- [ ] 모달에서 아이돌 드롭다운 열기/닫기 동작
- [ ] 그룹 접기/펼치기 동작
- [ ] 그룹 선택 시 "그룹한글명 그룹영어명"으로 검색어 설정
- [ ] 아이돌 선택 시 아이돌명으로 검색어 설정
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- "내 최애" 용어가 "아이돌"로 변경됨
- 커스텀 드롭다운이 그룹별 접기/펼치기 지원
- 그룹 클릭 시 그룹명으로 검색, 아이돌 클릭 시 아이돌명으로 검색
</success_criteria>

<output>
After completion, create `.planning/phases/23-unified-search-ux-improvements/23-01-SUMMARY.md`:

# Phase 23 Plan 01: Unified Search UX Improvements Summary

**[Substantive one-liner]**

## Accomplishments

- [Key outcome 1]
- [Key outcome 2]

## Files Created/Modified

- `path/to/file.ts` - Description

## Decisions Made

[Key decisions and rationale, or "None"]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Step

Phase 23 complete, ready for next milestone
</output>
