---
phase: 03-tagging-multi-bias
plan: 03
type: execute
depends_on: ["03-02"]
files_modified: [src/components/LinkCard.tsx, src/components/TagEditor.tsx, src/components/Sidebar.tsx, src/lib/links.ts]
---

<objective>
수동 태그 편집 UI 구현 - 링크에 태그 추가/삭제, 사이드바에 태그 목록 표시

Purpose: 자동 추출된 태그 외에 수동으로 태그를 관리하고, 태그 기반 필터링 준비
Output: LinkCard에 태그 표시/편집 UI + 사이드바에 전체 태그 목록
</objective>

<execution_context>
./.claude/get-shit-done/workflows/execute-plan.md
./summary.md
./.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/03-tagging-multi-bias/03-02-SUMMARY.md

**Prior decisions:**
- tags, link_tags 테이블 사용
- getOrCreateTag, addTagToLink, removeTagFromLink 함수 구현됨
- 자동 태그 추출 동작 중

**Key files:**
@src/lib/tags.ts
@src/components/LinkCard.tsx
@src/components/Sidebar.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: LinkCard에 태그 표시</name>
  <files>src/components/LinkCard.tsx, src/lib/links.ts</files>
  <action>
1. `src/lib/links.ts` 수정:
   - getLinks() 쿼리에 link_tags와 tags 조인 추가
   - 또는 별도 getLinksWithTags() 함수 생성
   - 반환 형식: Link & { tags: Tag[] }

2. `src/components/LinkCard.tsx` 수정:
   - props에 tags 추가 (Tag[] 타입)
   - 카드 하단에 태그 칩(chip) 형태로 표시
   - 스타일: 작은 둥근 배지, 배경색 구분

3. 태그 칩 스타일:
   - 배경: bg-blue-100 dark:bg-blue-900
   - 텍스트: text-blue-800 dark:text-blue-200
   - 크기: text-xs, px-2 py-0.5, rounded-full
  </action>
  <verify>npm run dev 후 저장된 링크에 태그 칩 표시 확인</verify>
  <done>LinkCard에 연결된 태그가 칩 형태로 표시됨</done>
</task>

<task type="auto">
  <name>Task 2: 태그 편집 UI (추가/삭제)</name>
  <files>src/components/TagEditor.tsx, src/components/LinkCard.tsx</files>
  <action>
1. `src/components/TagEditor.tsx` 생성:
   - props: linkId, currentTags, onTagsChange
   - 태그 추가: 텍스트 입력 + Enter 또는 "+" 버튼
   - 태그 삭제: 각 태그 칩에 X 버튼
   - API 호출: POST /api/tags (생성), 그 후 link_tags 연결

2. API 엔드포인트 필요:
   - POST /api/links/[id]/tags: 태그 연결
   - DELETE /api/links/[id]/tags/[tagId]: 연결 해제
   - `src/app/api/links/[id]/tags/route.ts` 생성

3. LinkCard에 TagEditor 통합:
   - 편집 모드 토글 (연필 아이콘 클릭)
   - 편집 모드에서 TagEditor 표시
   - 변경 후 목록 새로고침

UX:
- 태그 입력 시 자동완성 (기존 태그 목록에서)
- 중복 태그 추가 방지
  </action>
  <verify>
1. 링크 카드에서 편집 아이콘 클릭
2. 태그 입력 후 추가 → 칩 표시
3. X 버튼으로 삭제 → 칩 제거
  </verify>
  <done>수동으로 태그 추가/삭제가 UI에서 가능하고 즉시 반영됨</done>
</task>

<task type="auto">
  <name>Task 3: 사이드바 태그 목록 표시</name>
  <files>src/components/Sidebar.tsx</files>
  <action>
1. Sidebar.tsx의 "태그" 섹션 수정:
   - useEffect로 /api/tags GET 호출
   - 태그 목록 렌더링 (이름만 표시)
   - 각 태그 옆에 사용 횟수 표시 (선택)

2. 태그 목록 스타일:
   - 각 항목: 클릭 가능한 버튼 형태
   - hover 효과
   - 빈 상태: "태그가 없습니다" 유지

3. 클릭 시 필터링 (Phase 4 준비):
   - 클릭 시 선택 상태만 변경 (UI)
   - 실제 필터링은 Phase 4에서 구현
   - 선택된 태그 강조 스타일
  </action>
  <verify>npm run dev 후 사이드바에 생성된 태그 목록 표시 확인</verify>
  <done>사이드바에 전체 태그 목록이 표시되고 선택 UI 준비됨</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Phase 3 전체 - 최애 관리, 자동 태그, 수동 태그 편집</what-built>
  <how-to-verify>
    1. npm run dev 실행
    2. 사이드바에서 "+" 클릭하여 최애 추가 (예: RORA, BABYMONSTER)
    3. URL 입력하여 링크 저장
    4. 저장된 링크에 자동 태그 표시 확인
    5. 링크 카드에서 태그 편집하여 수동 태그 추가/삭제
    6. 사이드바에 태그 목록 표시 확인
  </how-to-verify>
  <resume-signal>Type "approved" or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `npm run build` 에러 없음
- [ ] 최애 추가/삭제 동작
- [ ] 링크 저장 시 자동 태그 추출
- [ ] 수동 태그 추가/삭제 동작
- [ ] 사이드바에 최애/태그 목록 표시
- [ ] 전체 흐름 사용자 검증 완료
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No TypeScript errors
- Phase 3 complete - Tagging & Multi-Bias 기능 전체 동작
</success_criteria>

<output>
After completion, create `.planning/phases/03-tagging-multi-bias/03-03-SUMMARY.md`
</output>
