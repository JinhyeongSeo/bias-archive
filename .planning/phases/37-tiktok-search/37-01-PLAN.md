---
phase: 37-tiktok-search
plan: 01
type: execute
depends_on: []
files_modified:
  - src/types/platforms.ts
  - src/lib/parsers/tiktok.ts
  - src/lib/parsers/index.ts
  - src/app/api/search/tiktok/route.ts
  - src/app/api/metadata/route.ts
  - src/components/ExternalSearch.tsx
  - src/components/LinkCard.tsx
  - messages/ko.json
  - messages/en.json
---

<objective>
TikTok ê²€ìƒ‰ ë° ë§í¬ ì €ì¥ ê¸°ëŠ¥ ì¶”ê°€

Purpose: í†µí•©ê²€ìƒ‰ì—ì„œ TikTok ì˜ìƒ ê²€ìƒ‰ ë° ì•„ì¹´ì´ë¸Œ ì €ì¥ ì§€ì›
Output: TikTok íƒ­ì´ ì¶”ê°€ëœ ExternalSearch, TikTok URL íŒŒì„œ, TikTok ê²€ìƒ‰ API
</objective>

<execution_context>
./.claude/get-shit-done/workflows/execute-plan.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/37-tiktok-search/DISCOVERY.md

**ì°¸ê³  íŒŒì¼ (Instagram êµ¬í˜„ íŒ¨í„´):**
@src/app/api/search/instagram/route.ts
@src/lib/parsers/instagram.ts
@src/types/platforms.ts
@src/components/ExternalSearch.tsx

**ê²°ì • ì‚¬í•­:**
- Apify TikTok Scraper ì‚¬ìš© (apidojo/tiktok-scraper)
- Instagramê³¼ ë™ì¼í•œ Apify íŒ¨í„´ ì ìš©
- ê¸°ì¡´ APIFY_API_TOKEN í™˜ê²½ ë³€ìˆ˜ ì¬ì‚¬ìš©
</context>

<tasks>

<task type="auto">
  <name>Task 1: Platform íƒ€ì… ë° TikTok íŒŒì„œ ì¶”ê°€</name>
  <files>src/types/platforms.ts, src/lib/parsers/tiktok.ts, src/lib/parsers/index.ts, src/app/api/metadata/route.ts</files>
  <action>
1. `src/types/platforms.ts` ìˆ˜ì •:
   - Platform íƒ€ì…ì— `'tiktok'` ì¶”ê°€ (instagram ë‹¤ìŒì—)
   - SearchCachePlatformì— `'tiktok'` ì¶”ê°€
   - TikTokResult ì¸í„°í˜ì´ìŠ¤ ì¶”ê°€ (InstagramResultì™€ ìœ ì‚¬)

2. `src/lib/parsers/tiktok.ts` ìƒì„± (instagram.ts ì°¸ê³ ):
   - parseTikTokUrl(): URLì—ì„œ username, videoId ì¶”ì¶œ
     - íŒ¨í„´: `/@username/video/videoId`
     - ë‹¨ì¶• URL: `vm.tiktok.com/XXXXX`
   - parseTikTok(url): HTML meta tag íŒŒì‹±
     - og:title, og:image, og:description ì¶”ì¶œ
     - authorName ì¶”ì¶œ (@ íŒ¨í„´)
     - platform: 'tiktok' ë°˜í™˜
     - í´ë°±: URL ê¸°ë°˜ ì •ë³´ ì‚¬ìš©
   - íƒ€ì„ì•„ì›ƒ: 8ì´ˆ (Instagramê³¼ ë™ì¼)

3. `src/lib/parsers/index.ts` ìˆ˜ì •:
   - `export { parseTikTok } from './tiktok'` ì¶”ê°€

4. `src/app/api/metadata/route.ts` ìˆ˜ì •:
   - TikTok URL ê°ì§€ ë° parseTikTok í˜¸ì¶œ ì¶”ê°€
   - íŒ¨í„´: `tiktok.com`, `vm.tiktok.com`
  </action>
  <verify>
- TypeScript ì»´íŒŒì¼ ì„±ê³µ: `npx tsc --noEmit`
- TikTok URL ê°ì§€ í…ŒìŠ¤íŠ¸: metadata APIê°€ tiktok.com URL ì²˜ë¦¬
  </verify>
  <done>
- Platform íƒ€ì…ì— 'tiktok' ì¶”ê°€ë¨
- TikTok íŒŒì„œê°€ ë©”íƒ€ë°ì´í„° ì¶”ì¶œ ê°€ëŠ¥
- metadata APIê°€ TikTok URL ì²˜ë¦¬
  </done>
</task>

<task type="auto">
  <name>Task 2: TikTok ê²€ìƒ‰ API ë¼ìš°íŠ¸ ìƒì„±</name>
  <files>src/app/api/search/tiktok/route.ts</files>
  <action>
`src/app/api/search/tiktok/route.ts` ìƒì„± (instagram/route.ts ì°¸ê³ ):

1. í™˜ê²½ ë³€ìˆ˜ ì²´í¬: `APIFY_API_TOKEN`
   - ì—†ìœ¼ë©´ `{ notConfigured: true }` ë°˜í™˜

2. ApifyClient ì´ˆê¸°í™” ë° Actor í˜¸ì¶œ:
   - Actor: `apidojo/tiktok-scraper`
   - Input íŒŒë¼ë¯¸í„°:
     ```typescript
     {
       hashtags: [hashtag],  // # ì œê±°ëœ ê²€ìƒ‰ì–´
       resultsPerPage: limit,  // ê¸°ë³¸ 10, ìµœëŒ€ 20
       shouldDownloadVideos: false,
       shouldDownloadCovers: false,
     }
     ```
   - íƒ€ì„ì•„ì›ƒ: 55ì´ˆ (Vercel 60s ì œí•œ)

3. ê²°ê³¼ ë³€í™˜ (TikTokSearchResult í˜•ì‹):
   ```typescript
   interface TikTokSearchResult {
     url: string           // https://www.tiktok.com/@author/video/id
     title: string         // description (50ì ì œí•œ)
     thumbnailUrl: string  // videoMeta.cover
     author: string        // authorMeta.name or authorMeta.uniqueId
     media: ParsedMedia[]  // [{ type: 'video', url: videoUrl }]
   }
   ```

4. ì—ëŸ¬ ì²˜ë¦¬:
   - íƒ€ì„ì•„ì›ƒ: 504 ì—ëŸ¬
   - API í‚¤ ë¬¸ì œ: 500 ì—ëŸ¬
   - Rate limit: 429 ì—ëŸ¬

5. maxDuration: 60 (Vercel Hobby ìµœëŒ€)
  </action>
  <verify>
- API ë¼ìš°íŠ¸ ì¡´ì¬ í™•ì¸: `ls src/app/api/search/tiktok/route.ts`
- TypeScript ì»´íŒŒì¼: `npx tsc --noEmit`
  </verify>
  <done>
- TikTok ê²€ìƒ‰ APIê°€ `/api/search/tiktok?q=ê²€ìƒ‰ì–´` í˜•ì‹ìœ¼ë¡œ ë™ì‘
- notConfigured ì‘ë‹µ ë˜ëŠ” ê²€ìƒ‰ ê²°ê³¼ ë°˜í™˜
  </done>
</task>

<task type="auto">
  <name>Task 3: ExternalSearch UIì— TikTok íƒ­ ì¶”ê°€</name>
  <files>src/components/ExternalSearch.tsx, src/components/LinkCard.tsx, messages/ko.json, messages/en.json</files>
  <action>
1. `src/components/ExternalSearch.tsx` ìˆ˜ì •:
   - Platform íƒ€ì…ì— 'tiktok' ì¶”ê°€ (ë¡œì»¬ íƒ€ì…)
   - TikTokResult ì¸í„°í˜ì´ìŠ¤ ì¶”ê°€ (InstagramResultì™€ ë™ì¼ êµ¬ì¡°)
   - í”Œë«í¼ íƒ­ì— TikTok ì¶”ê°€ (Instagram ë‹¤ìŒ)
     - ì•„ì´ì½˜: ğŸµ ë˜ëŠ” TikTok ë¡œê³  SVG
     - ë¼ë²¨: "TikTok"
   - searchTikTok í•¨ìˆ˜ ì¶”ê°€:
     ```typescript
     const searchTikTok = async (searchQuery: string) => {
       const response = await fetch(`/api/search/tiktok?q=${encodeURIComponent(searchQuery)}&limit=10`)
       // Instagramê³¼ ë™ì¼í•œ ê²°ê³¼ ì²˜ë¦¬ íŒ¨í„´
     }
     ```
   - handleSearchì— tiktok case ì¶”ê°€
   - renderResultsì— tiktok ê²°ê³¼ ë Œë”ë§ ì¶”ê°€
   - notConfigured ì²˜ë¦¬ ì¶”ê°€

2. `src/components/LinkCard.tsx` ìˆ˜ì •:
   - TikTok í”Œë«í¼ ì•„ì´ì½˜ ì¶”ê°€
   - ìƒ‰ìƒ: ê²€ì •ìƒ‰ ë˜ëŠ” í•«í•‘í¬ (#ff0050)
   - ì•„ì´ì½˜: ğŸµ ë˜ëŠ” TikTok ë¡œê³  (ê°„ë‹¨í•œ ìŒí‘œ SVG)

3. `messages/ko.json` ìˆ˜ì •:
   - "tiktok": "TikTok" ì¶”ê°€ (platform ì„¹ì…˜)
   - "tiktokNotConfigured": "TikTok ê²€ìƒ‰ì´ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤" ì¶”ê°€

4. `messages/en.json` ìˆ˜ì •:
   - "tiktok": "TikTok" ì¶”ê°€
   - "tiktokNotConfigured": "TikTok search is not configured" ì¶”ê°€
  </action>
  <verify>
- ê°œë°œ ì„œë²„ ì‹¤í–‰: `npm run dev`
- ExternalSearch ëª¨ë‹¬ì—ì„œ TikTok íƒ­ í‘œì‹œ í™•ì¸
- ë¹Œë“œ ì„±ê³µ: `npm run build`
  </verify>
  <done>
- ExternalSearchì— TikTok íƒ­ í‘œì‹œ
- TikTok ê²€ìƒ‰ ê²°ê³¼ê°€ ëª©ë¡ì— í‘œì‹œ
- LinkCardì— TikTok í”Œë«í¼ ì•„ì´ì½˜ í‘œì‹œ
- ë‹¤êµ­ì–´ ì§€ì› ì™„ë£Œ
  </done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `npm run build` ì„±ê³µ
- [ ] TikTok URL ì €ì¥ í…ŒìŠ¤íŠ¸: `https://www.tiktok.com/@username/video/123` í˜•ì‹ URL ì €ì¥
- [ ] ExternalSearchì—ì„œ TikTok íƒ­ í‘œì‹œ
- [ ] TikTok ê²€ìƒ‰ API ì‘ë‹µ (notConfigured ë˜ëŠ” ê²°ê³¼)
- [ ] LinkCardì— TikTok ì•„ì´ì½˜ í‘œì‹œ
</verification>

<success_criteria>
- TikTok URL íŒŒì„œ ë™ì‘ (ë©”íƒ€ë°ì´í„° ì¶”ì¶œ)
- TikTok ê²€ìƒ‰ API ë™ì‘ (Apify ì—°ë™)
- ExternalSearchì— TikTok íƒ­ í‘œì‹œ ë° ê²€ìƒ‰ ê°€ëŠ¥
- ê²€ìƒ‰ ê²°ê³¼ ì•„ì¹´ì´ë¸Œ ì €ì¥ ê°€ëŠ¥
- LinkCardì— TikTok í”Œë«í¼ ì•„ì´ì½˜ í‘œì‹œ
- ë¹Œë“œ ì„±ê³µ
</success_criteria>

<output>
After completion, create `.planning/phases/37-tiktok-search/37-01-SUMMARY.md`:

# Phase 37 Plan 01: TikTok Search Summary

**TikTok ê²€ìƒ‰ ë° ë§í¬ ì €ì¥ ê¸°ëŠ¥ êµ¬í˜„ ì™„ë£Œ**

## Accomplishments

- TikTok URL íŒŒì„œ ìƒì„± (ë©”íƒ€ë°ì´í„° ì¶”ì¶œ)
- Apify TikTok Scraper ê¸°ë°˜ ê²€ìƒ‰ API êµ¬í˜„
- ExternalSearchì— TikTok íƒ­ ì¶”ê°€
- LinkCardì— TikTok í”Œë«í¼ ì•„ì´ì½˜ ì¶”ê°€
- ë‹¤êµ­ì–´ ì§€ì› (ko/en)

## Files Created/Modified

- `src/types/platforms.ts` - Platform íƒ€ì…ì— tiktok ì¶”ê°€
- `src/lib/parsers/tiktok.ts` - TikTok URL íŒŒì„œ (ì‹ ê·œ)
- `src/lib/parsers/index.ts` - parseTikTok export
- `src/app/api/search/tiktok/route.ts` - TikTok ê²€ìƒ‰ API (ì‹ ê·œ)
- `src/app/api/metadata/route.ts` - TikTok URL ì²˜ë¦¬ ì¶”ê°€
- `src/components/ExternalSearch.tsx` - TikTok íƒ­ ì¶”ê°€
- `src/components/LinkCard.tsx` - TikTok ì•„ì´ì½˜ ì¶”ê°€
- `messages/ko.json`, `messages/en.json` - ë²ˆì—­ ì¶”ê°€

## Decisions Made

- Apify apidojo/tiktok-scraper Actor ì‚¬ìš©
- Instagramê³¼ ë™ì¼í•œ Apify íŒ¨í„´ ì ìš©
- íƒ€ì„ì•„ì›ƒ 55ì´ˆ (Vercel 60s ì œí•œ)

## Issues Encountered

[êµ¬í˜„ ì¤‘ ë°œìƒí•œ ì´ìŠˆ]

## Next Step

Phase 37 complete
</output>
